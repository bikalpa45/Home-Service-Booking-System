{% extends 'index.html' %}
{% load static %}
{% block body %}

<header>
    {% comment %} <div class="w3l_banner_info" style="height: 10px;">
        <div class="slider1">
            <div class="callbacks_container">
                <ul class="rslides" id="slider3">
                    <li>
                        <div class="slider1-img" style="height: 90px;">
                            <div class="slider_banner_info">
                                <!-- Add banner info here if needed -->
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</header> {% endcomment %}

<!-- Main Content -->
<div class="container mt-5">
    <h2 class="text-center font-weight-bold text-danger mt-4" style="font-family: 'Monotype Corsiva';">Update Profile</h2>
    <hr>

    <div class="row">
        <div class="col-md-8">
            <form id="myForm" method="post" action="" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="inputFirstName">First Name</label>
                        <input type="text" class="form-control" value="{{ pro.user.first_name }}" name="fname" id="inputFirstName">
                    </div>
                    <div class="form-group col-md-6">
                        <label for="inputLastName">Last Name</label>
                        <input type="text" class="form-control" name="lname" value="{{ pro.user.last_name }}" id="inputLastName">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-12">
                        <label for="inputUsername">Username</label>
                        <input type="text" class="form-control" name="uname" value="{{ pro.user.username }}" id="inputUsername" readonly>
                    </div>
                    <div class="form-group col-md-12">
                        <label for="inputEmail">Email Address</label>
                        <input type="email" class="form-control" name="email" value="{{ pro.user.email }}" id="inputEmail">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-12">
                        <label for="inputAddress">Address</label>
                        <input type="text" class="form-control" name="address" value="{{ pro.address }}" id="inputAddress">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-12">
                        <label for="inputContact">Contact</label>
                        <input type="text" class="form-control" id="inputContact" value="{{ pro.contact }}" name="contact">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-10">
                        <label for="inputImage">Image</label>
                        <input type="file" class="form-control" id="inputImage" name="image">
                    </div>
                    <div class="form-group col-md-2">
                        <label></label>
                        <img src="{{ pro.image.url }}" style="width: 100px; height: 110px;">
                    </div>
                </div>
                <p class="font-weight-bold text-danger py-3">Your Service Detail</p>
                <hr>
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="selectCity">Work Experience</label>
                        <select class="form-control" name="city" id="selectCity">
                            {% for i in city %}
                                <option value="{{ i.city }}" {% if i.city == pro.city.city %} selected {% endif %}>{{ i.city }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="inputDob">Date of Birth</label>
                        <input type="date" class="form-control" id="inputDob" name="dob" max="">

                        <div class="error" id="dobError" style="color: red;"></div>
                    </div>
                </div>
                <div class="form-group col-md-6">
                    <label for="selectService">Select Your Service</label>
                    <select class="form-control" name="service" id="selectService">
                        {% for i in ser %}
                            <option value="{{ i.category }}" {% if i.category == pro.service_name %} selected {% endif %}>{{ i.category }}</option>
                        {% endfor %}
                    </select>
                </div>
                <button type="submit" class="btn btn-primary mb-5">Update</button>
            </form>
        </div>
    </div>
</div>

{% if terror %}
<script>

document.addEventListener('DOMContentLoaded', function() {
    var dobInput = document.getElementById('inputDob');
    var today = new Date();
    
    
    var maxDate = new Date(today.getFullYear() - 18, today.getMonth(), today.getDate() - 1);

    
    var day = String(maxDate.getDate()).padStart(2, '0');
    var month = String(maxDate.getMonth() + 1).padStart(2, '0'); 
    var year = maxDate.getFullYear();
    var formattedDate = `${year}-${month}-${day}`;
    
    
    dobInput.setAttribute('max', formattedDate);
});

document.getElementById('myForm').addEventListener('submit', function(event) {
    
    event.preventDefault();

    var dobInput = document.getElementById('inputDob');
    var dobError = document.getElementById('dobError');
    var dob = new Date(dobInput.value);
    var today = new Date();
    var age = today.getFullYear() - dob.getFullYear();
    var month = today.getMonth() - dob.getMonth();

    
    if (month < 0 || (month === 0 && today.getDate() < dob.getDate())) {
        age--;
    }

    
    if (age < 18) {
        dobError.textContent = 'You must be at least 18 years old.';
    } else {
        dobError.textContent = ''; 
        
        document.getElementById('myForm').submit(); 
    }
});
</script>
{% endif %}

{% endblock %}
